<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tutorial &mdash; dimelo  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="../_static/sg_gallery-rendered-html.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Basecalling &amp; Alignment Suggestions" href="basecalling.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> dimelo
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/tools.html">Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Example Gallery</a></li>
<li class="toctree-l1"><a class="reference internal" href="basecalling.html">Basecalling &amp; Alignment Suggestions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#files-needed">Files needed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#steps">Steps</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">dimelo</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/content/tutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this headline"></a></h1>
<p>Follow the steps here to run the dimelo package with a test dataset.</p>
<section id="files-needed">
<h2>Files needed<a class="headerlink" href="#files-needed" title="Permalink to this headline"></a></h2>
<p>Files can be found in directory: <code class="docutils literal notranslate"><span class="pre">dimelo/test/data</span></code></p>
<ol class="arabic simple">
<li><p>ctcf_demo.sorted.bam</p></li>
<li><p>ctcf_demo.sorted.bam.bai</p></li>
<li><p>ctcf_demo_peak.bed</p></li>
<li><p>ctcf_demo_not_peak.bed</p></li>
</ol>
</section>
<section id="steps">
<h2>Steps<a class="headerlink" href="#steps" title="Permalink to this headline"></a></h2>
<ol class="arabic simple">
<li><p><a class="reference internal" href="installation.html"><span class="doc">Installation</span></a></p></li>
<li><p>Run below commands and ensure your output matches the expected plots below. This tutorial walks through running functions from python, but the dimelo package can also be used from the command line (see <a class="reference internal" href="../auto_examples/index.html"><span class="doc">Example Gallery</span></a>).</p></li>
</ol>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dimelo</span> <span class="k">as</span> <span class="nn">dm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bam</span> <span class="o">=</span> <span class="s2">&quot;dimelo/test/data/ctcf_demo.sorted.bam&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampleName</span> <span class="o">=</span> <span class="s2">&quot;CTCF_demo&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">outDir</span> <span class="o">=</span> <span class="s2">&quot;out&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedPeak</span> <span class="o">=</span> <span class="s2">&quot;dimelo/test/data/ctcf_demo_peak.bed&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bedNotPeak</span> <span class="o">=</span> <span class="s2">&quot;dimelo/test/data/ctcf_demo_not_peak.bed&quot;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="o">.</span><span class="n">qc_report</span><span class="p">(</span><span class="n">bam</span><span class="p">,</span> <span class="n">sampleName</span><span class="p">,</span> <span class="n">outDir</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/CTCF_demo_qc_report.png" class="align-center" src="../_images/CTCF_demo_qc_report.png" />
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="o">.</span><span class="n">plot_enrichment</span><span class="p">(</span><span class="n">bam</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;CTCF_peak&#39;</span><span class="p">,</span> <span class="s1">&#39;CTCF_not_peak&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">bedPeak</span><span class="p">,</span> <span class="n">bedNotPeak</span><span class="p">],</span> <span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="n">outDir</span><span class="p">,</span> <span class="n">threshA</span><span class="o">=</span><span class="mi">190</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/sample_ctcf_demo.sorted_A_enrichment_barplot.png" class="align-center" src="../_images/sample_ctcf_demo.sorted_A_enrichment_barplot.png" />
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="o">.</span><span class="n">plot_enrichment_profile</span><span class="p">(</span><span class="n">bam</span><span class="p">,</span> <span class="n">sampleName</span><span class="p">,</span> <span class="n">bedPeak</span><span class="p">,</span><span class="s2">&quot;A+CG&quot;</span><span class="p">,</span><span class="n">outDir</span><span class="p">,</span><span class="n">threshA</span><span class="o">=</span><span class="mi">190</span><span class="p">,</span><span class="n">threshC</span><span class="o">=</span><span class="mi">190</span><span class="p">)</span>
</pre></div>
</div>
<p>Aggregate rolling average fraction of methylated bases</p>
<img alt="../_images/CTCF_demo_A+CG_sm_rolling_avg.png" class="align-center" src="../_images/CTCF_demo_A+CG_sm_rolling_avg.png" />
<p>Single molecules with binary mA and mCpG colored</p>
<img alt="../_images/CTCF_demo_A+CG_sm_scatter.png" class="align-center" src="../_images/CTCF_demo_A+CG_sm_scatter.png" />
<p>A base count</p>
<img alt="../_images/CTCF_demo_A_base_count.png" class="align-center" src="../_images/CTCF_demo_A_base_count.png" />
<p>CG base count</p>
<img alt="../_images/CTCF_demo_CG_base_count.png" class="align-center" src="../_images/CTCF_demo_CG_base_count.png" />
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dm</span><span class="o">.</span><span class="n">plot_browser</span><span class="p">(</span><span class="n">bam</span><span class="p">,</span> <span class="n">sampleName</span><span class="p">,</span> <span class="s2">&quot;chr11:2086423-2091187&quot;</span><span class="p">,</span> <span class="s2">&quot;A+CG&quot;</span><span class="p">,</span> <span class="n">outDir</span><span class="p">,</span> <span class="n">threshA</span><span class="o">=</span><span class="mi">153</span><span class="p">,</span> <span class="n">threshC</span><span class="o">=</span><span class="mi">153</span><span class="p">,</span> <span class="n">static</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">min_periods</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/methylation_browser_chr11_2086423_20911871.png" class="align-center" src="../_images/methylation_browser_chr11_2086423_20911871.png" />
<img alt="../_images/CTCF_demo_A_sm_rolling_avg_fraction.png" class="align-center" src="../_images/CTCF_demo_A_sm_rolling_avg_fraction.png" />
<img alt="../_images/CTCF_demo_A_sm_rolling_avg_total.png" class="align-center" src="../_images/CTCF_demo_A_sm_rolling_avg_total.png" />
<img alt="../_images/CTCF_demo_C_sm_rolling_avg_fraction.png" class="align-center" src="../_images/CTCF_demo_C_sm_rolling_avg_fraction.png" />
<img alt="../_images/CTCF_demo_C_sm_rolling_avg_total.png" class="align-center" src="../_images/CTCF_demo_C_sm_rolling_avg_total.png" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="basecalling.html" class="btn btn-neutral float-left" title="Basecalling &amp; Alignment Suggestions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Annie Maslan &amp; Reet Mishra &amp; Jeremy Marcus.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>